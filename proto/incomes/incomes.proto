syntax = "proto3";

package incomes;

import "addresses/addresses.proto";
import "common/errors.proto";
import "common/numbers.proto";
import "common/statuses.proto";
import "countries/countries.proto";
import "uoms/uoms.proto";
import "kyc/kyc.proto";
import "google/protobuf/timestamp.proto";

enum Type {
  TYPE_UNSPECIFIED = 0;
  TYPE_SALARY = 1;
  TYPE_FEES = 2;
  TYPE_DIVIDENDS = 3;
  TYPE_INVESTMENT = 4;
  TYPE_PENSION = 5;
  TYPE_OTHER = 255;
}

message TypeList {
  repeated Type list = 1;
}

// Backed by table 'kyc_incomes'
message Income {
  string id = 1; // System Key: id is generated by the server or the database
  Type type = 2;
  optional common.Decimal amount_year = 3;
  optional common.Decimal amount_month = 4;
  optional common.Decimal amount_week = 5;
  optional common.Decimal amount_day = 6;
  optional common.Decimal amount_hour = 7;
  optional uoms.UoM currency = 8;
  optional string description = 9;
  optional string employer = 10;
  optional string industry = 11;
  optional string occupation = 12;
  optional string employment_type = 13;
  optional string employment_status = 14;
  optional string employment_start_date = 15;
  optional string company = 16;
  optional string investment_vehicle = 17;
  optional addresses.Address property_address = 18;
  optional countries.Country from_country = 19;
  common.Status status = 20;
}

message List {
  repeated Income list = 1;
}

message SelectList {
  repeated string list = 1;
}

message Salary {
  optional common.Decimal amount_year = 1;
  optional common.Decimal amount_month = 2;
  optional common.Decimal amount_week = 3;
  optional common.Decimal amount_day = 4;
  optional common.Decimal amount_hour = 5;
  optional uoms.UoM currency = 6;
  optional string employer = 7;
  optional string industry = 8;
  optional string occupation = 9;
  optional string employment_type = 10;
  optional string employment_status = 11;
  optional string employment_start_date = 12;
}

message SetSalary {
  optional common.Decimal amount_year = 1;
  optional common.Decimal amount_month = 2;
  optional common.Decimal amount_week = 3;
  optional common.Decimal amount_day = 4;
  optional common.Decimal amount_hour = 5;
  optional uoms.Select currency = 6;
  optional string employer = 7;
  optional string industry = 8;
  optional string occupation = 9;
  optional string employment_type = 10;
  optional string employment_status = 11;
  optional string employment_start_date = 12;
}

message Freelancing {
  optional common.Decimal amount_year = 1;
  optional common.Decimal amount_month = 2;
  optional common.Decimal amount_week = 3;
  optional common.Decimal amount_day = 4;
  optional common.Decimal amount_hour = 5;
  optional uoms.UoM currency = 6;
  optional string occupation = 7;
}

message SetFreelancing {
  optional common.Decimal amount_year = 1;
  optional common.Decimal amount_month = 2;
  optional common.Decimal amount_week = 3;
  optional common.Decimal amount_day = 4;
  optional common.Decimal amount_hour = 5;
  optional uoms.Select currency = 6;
  optional string occupation = 7;
}

message Dividends {
  optional common.Decimal amount_year = 1;
  optional uoms.UoM currency = 2;
  optional string company = 3;
  optional string industry = 4;
}

message SetDividends {
  optional common.Decimal amount_year = 1;
  optional uoms.Select currency = 2;
  optional string company = 3;
  optional string industry = 4;
}

message Investment {
  optional common.Decimal amount_year = 1;
  optional common.Decimal amount_month = 2;
  optional uoms.UoM currency = 3;
  optional string investment_vehicle = 4;
}

message SetInvestment {
  optional common.Decimal amount_year = 1;
  optional common.Decimal amount_month = 2;
  optional uoms.Select currency = 3;
  optional string investment_vehicle = 4;
}

message Rent {
  optional common.Decimal amount_year = 1;
  optional common.Decimal amount_month = 2;
  optional common.Decimal amount_week = 3;
  optional common.Decimal amount_day = 4;
  optional common.Decimal amount_hour = 5;
  optional uoms.UoM currency = 6;
  optional addresses.CreateRequest property_address = 7;
}

message SetRent {
  optional common.Decimal amount_year = 1;
  optional common.Decimal amount_month = 2;
  optional common.Decimal amount_week = 3;
  optional common.Decimal amount_day = 4;
  optional common.Decimal amount_hour = 5;
  optional uoms.Select currency = 6;
  optional addresses.CreateRequest property_address = 7;
}

message Pension {
  optional common.Decimal amount_year = 1;
  optional common.Decimal amount_month = 2;
  optional common.Decimal amount_week = 3;
  optional common.Decimal amount_day = 4;
  optional uoms.UoM currency = 5;
  optional countries.Select from_country = 6;
}

message SetPension {
  optional common.Decimal amount_year = 1;
  optional common.Decimal amount_month = 2;
  optional common.Decimal amount_week = 3;
  optional common.Decimal amount_day = 4;
  optional uoms.Select currency = 5;
  optional countries.Select from_country = 6;
}

message Other {
  optional common.Decimal amount_year = 1;
  optional common.Decimal amount_month = 2;
  optional common.Decimal amount_week = 3;
  optional common.Decimal amount_day = 4;
  optional common.Decimal amount_hour = 5;
  optional uoms.UoM currency = 6;
  optional string description = 7;
}

message SetOther {
  optional common.Decimal amount_year = 1;
  optional common.Decimal amount_month = 2;
  optional common.Decimal amount_week = 3;
  optional common.Decimal amount_day = 4;
  optional common.Decimal amount_hour = 5;
  optional uoms.Select currency = 6;
  optional string description = 7;
}

message CreateRequest {
  // id is generated by the server or the database
  oneof select { // type is determined automatically according to select
    SetSalary salary = 1;
    SetFreelancing freelancing = 2;
    SetDividends dividends = 3;
    SetInvestment investment = 4;
    SetRent rent = 5;
    SetPension pension = 6;
    SetOther other = 7;
  }
  optional common.Status status = 8; // Default: STATUS_UNSPECIFIED, which means Income needs to be activated after creation
}

message CreateResponse {
  oneof response {
    common.Error error = 1;
    Income income = 2;
  }
}

message UpdateRequest {
  string id = 1;
  oneof select { // type is determined automatically according to select
    SetSalary salary = 2;
    SetFreelancing freelancing = 3;
    SetDividends dividends = 4;
    SetInvestment investment = 5;
    SetRent rent = 6;
    SetPension pension = 7;
    SetOther other = 8;
  }
  optional common.Status status = 9;
}

message UpdateResponse {
  oneof response {
    common.Error error = 1;
    Income income = 2;
  }
}

// GetRequest is expected to return a single value.
message GetRequest {
  string id = 1;
}

// An error is returned if there is more than one record found.
message GetResponse {
  oneof response {
    common.Error error = 1;
    Income income = 2;
  }
}

// GetList will use SQL 'LIKE' instead of '=' for string fields
message GetListRequest {
  optional TypeList type = 1;
  optional common.Decimal amount_year = 2;
  optional common.Decimal amount_month = 3;
  optional common.Decimal amount_week = 4;
  optional common.Decimal amount_day = 5;
  optional common.Decimal amount_hour = 6;
  optional uoms.GetListRequest currency = 7;
  optional string description = 8;
  optional string employer = 9;
  optional string industry = 10;
  optional string occupation = 11;
  optional string employment_type = 12;
  optional string employment_status = 13;
  optional string employment_start_date = 14;
  optional string company = 15;
  optional string investment_vehicle = 16;
  optional addresses.GetListRequest property_address = 17;
  optional countries.GetListRequest from_country = 18;
  optional common.StatusList status = 19;
}

message GetListResponse {
  oneof response {
    common.Error error = 1;
    Income income = 2;
  }
}

// A delete request is just an update request with status set to TERMINATED.
message DeleteRequest {
  string id = 1;
}

message DeleteResponse {
  oneof response {
    common.Error error = 1;
    Income income = 2;
  }
}

// Labeled Income messages are used in Entities that requires Labeled Income Assignment

message LabeledIncome {
  string label = 1;
  Income income = 2;
  kyc.Status status = 3;
}

message LabeledIncomeList {
  repeated LabeledIncome list = 1;
}

// Assign existing income or create and assign new income to Entity
message SetLabeledIncome {
  string label = 1;
  oneof response {
    string id = 2;
    CreateRequest income = 3;
  }
  kyc.Status status = 4;
}

message SetLabeledIncomeList {
  repeated SetLabeledIncome list = 1;
}

message UpdateLabeledIncome {
  optional string label = 1;
  optional Type type = 2;
  optional string value = 3;
  optional common.Status status = 4;
}

message UpdateLabeledIncomeRequest {
  string by_label = 1;
  UpdateLabeledIncome address = 2;
  kyc.Status status = 3;
}

// Unlabeled Income messages are used in Entities that requires UnLabeled Income Assignment

message UpdateIncome {
  optional Type type = 1;
  optional string value = 2;
  optional common.Status status = 3;
}
